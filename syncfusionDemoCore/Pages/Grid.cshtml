@page
@using syncfusionDemoCore.Pages
@model syncfusionDemoCore.Pages.GridModel



<div class="h-100">
    <ejs-grid id="Grid" toolbarClick="toolbarClick" pdfExportComplete="pdfExportComplete" excelExportComplete="excelExportComplete" enableInfiniteScrolling="true" height="800" allowPdfExport="true" allowExcelExport="true" toolbar="@(new List<string>() { "Search", "PdfExport", "ExcelExport"})" dataSource="@Model.ListaDatos" allowPaging="true" rowHeight="60" allowFiltering="true" allowSorting="true" allowGrouping="true">
        <e-grid-groupsettings columns="@(new string[] {})"></e-grid-groupsettings>
        <e-grid-filterSettings type="Menu"></e-grid-filterSettings>
        <e-grid-columns>
            <e-grid-column field="CodigoBodega" headerText="Código Bodega" textAlign="Center" width="120"></e-grid-column>
            <e-grid-column field="Bodega" textAlign="Center" width="120"></e-grid-column>
            <e-grid-column field="Serie" headerText="Serie" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="NoFactura" headerText="No. Factura" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="Fecha" textAlign="Left" format="dd/MMMM/yyyy" width="120"></e-grid-column>
            <e-grid-column field="Credito" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="Comentario" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="NoPedido" headerText="No. Pedido" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="CodigoCliente" headerText="Código Cliente" textAlign="Center" width="120"></e-grid-column>
            <e-grid-column field="NIT" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="Cliente" textAlign="Center" width="120"></e-grid-column>
            <e-grid-column field="CodigoVendedor" headerText="Código Vendedor" textAlign="Center" width="120"></e-grid-column>
            <e-grid-column field="Vendedor" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="CodigoProducto" headerText="Código Producto" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="NombreProducto" headerText="Nombre Producto" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="FamiliaProducto" headerText="Familia" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="TipoProducto" headerText="Tipo Producto" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="LineaProducto" headerText="Linea Producto" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="ClaseProducto" headerText="Clase Producto" textAlign="Left" width="120"></e-grid-column>
            <e-grid-column field="CantidadVenta" headerText="Cantidad Venta" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="PrecioUnitario" headerText="Precio Unitario" textAlign="Right" width="120"></e-grid-column>
            <e-grid-column field="Total" textAlign="Right" width="120"></e-grid-column>
        </e-grid-columns>

    </ejs-grid>

</div>

<script>
    function toolbarClick(args) {
        var gridObj = document.getElementById("Grid").ej2_instances[0];
        if (args.item.id === 'Grid_pdfexport') {
            gridObj.showSpinner();
            gridObj.pdfExport();
        }
        else if (args.item.id === 'Grid_excelexport') {
            gridObj.showSpinner();
            gridObj.excelExport();
        }
    }

    function pdfExportComplete(args) {
        this.hideSpinner();
    }

    function excelExportComplete(args) {
        this.hideSpinner();
    }
</script>